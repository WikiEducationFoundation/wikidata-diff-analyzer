require './lib/wikidata/diff/analyzer'
require 'rspec'

# testcases for lexeme
RSpec.describe do
    # Replace the REVISION_ID you want to see with the rev id

    # HTML: https://www.wikidata.org/w/index.php?diff=[REVISION_ID]
    # JSON: https://www.wikidata.org/w/api.php?action=query&prop=revisions&revids=[REVISION_ID]&rvslots=main&rvprop=content|ids|comment&format=json
    it 'returns the lexeme edits' do
      revision_ids = [1007241555, 1007241817, 1007242285, 1007242344, 1007242344, 1007242377, 1007242410, 1007242454, 1007242480, 1007242733]
     
      analyzed_revisions = WikidataDiffAnalyzer.analyze(revision_ids)
      expected_result = {:diffs_analyzed_count=>9, :diffs_not_analyzed=>[], :diffs=>{1007241555=>{:added_claims=>0, :removed_claims=>0, :changed_claims=>0, :added_references=>0, :removed_references=>0, :changed_references=>0, :added_qualifiers=>0, :removed_qualifiers=>0, :changed_qualifiers=>0, :added_aliases=>0, :removed_aliases=>0, :changed_aliases=>0, :added_labels=>0, :removed_labels=>0, :changed_labels=>0, :added_descriptions=>0, :removed_descriptions=>0, :changed_descriptions=>0, :added_sitelinks=>0, :removed_sitelinks=>0, :changed_sitelinks=>0, :added_forms=>0, :removed_forms=>0, :changed_forms=>0, :added_representations=>0, :removed_representations=>0, :changed_representations=>0, :added_formclaims=>0, :removed_formclaims=>0, :changed_formclaims=>0, :added_lemmas=>1, :removed_lemmas=>0, :changed_lemmas=>0, :added_senses=>0, :removed_senses=>0, :changed_senses=>0, :added_glosses=>0, :removed_glosses=>0, :changed_glosses=>0, :added_senseclaims=>0, :removed_senseclaims=>0, :changed_senseclaims=>0, :merge_to=>0, :merge_from=>0, :redirect=>0, :undo=>0, :restore=>0, :clear_item=>0, :create_item=>0, :create_property=>0, :create_lexeme=>1}, 1007241817=>{:added_claims=>0, :removed_claims=>0, :changed_claims=>0, :added_references=>0, :removed_references=>0, :changed_references=>0, :added_qualifiers=>0, :removed_qualifiers=>0, :changed_qualifiers=>0, :added_aliases=>0, :removed_aliases=>0, :changed_aliases=>0, :added_labels=>0, :removed_labels=>0, :changed_labels=>0, :added_descriptions=>0, :removed_descriptions=>0, :changed_descriptions=>0, :added_sitelinks=>0, :removed_sitelinks=>0, :changed_sitelinks=>0, :added_forms=>1, :removed_forms=>0, :changed_forms=>0, :added_representations=>1, :removed_representations=>0, :changed_representations=>0, :added_formclaims=>0, :removed_formclaims=>0, :changed_formclaims=>0, :added_lemmas=>0, :removed_lemmas=>0, :changed_lemmas=>0, :added_senses=>0, :removed_senses=>0, :changed_senses=>0, :added_glosses=>0, :removed_glosses=>0, :changed_glosses=>0, :added_senseclaims=>0, :removed_senseclaims=>0, :changed_senseclaims=>0, :merge_to=>0, :merge_from=>0, :redirect=>0, :undo=>0, :restore=>0, :clear_item=>0, :create_item=>0, :create_property=>0, :create_lexeme=>0}, 1007242285=>{:added_claims=>1, :removed_claims=>0, :changed_claims=>0, :added_references=>0, :removed_references=>0, :changed_references=>0, :added_qualifiers=>0, :removed_qualifiers=>0, :changed_qualifiers=>0, :added_aliases=>0, :removed_aliases=>0, :changed_aliases=>0, :added_labels=>0, :removed_labels=>0, :changed_labels=>0, :added_descriptions=>0, :removed_descriptions=>0, :changed_descriptions=>0, :added_sitelinks=>0, :removed_sitelinks=>0, :changed_sitelinks=>0, :added_forms=>0, :removed_forms=>0, :changed_forms=>1, :added_representations=>0, :removed_representations=>0, :changed_representations=>0, :added_formclaims=>0, :removed_formclaims=>0, :changed_formclaims=>0, :added_lemmas=>0, :removed_lemmas=>0, :changed_lemmas=>0, :added_senses=>0, :removed_senses=>0, :changed_senses=>0, :added_glosses=>0, :removed_glosses=>0, :changed_glosses=>0, :added_senseclaims=>0, :removed_senseclaims=>0, :changed_senseclaims=>0, :merge_to=>0, :merge_from=>0, :redirect=>0, :undo=>0, :restore=>0, :clear_item=>0, :create_item=>0, :create_property=>0, :create_lexeme=>0}, 1007242344=>{:added_claims=>1, :removed_claims=>0, :changed_claims=>0, :added_references=>0, :removed_references=>0, :changed_references=>0, :added_qualifiers=>1, :removed_qualifiers=>0, :changed_qualifiers=>0, :added_aliases=>0, :removed_aliases=>0, :changed_aliases=>0, :added_labels=>0, :removed_labels=>0, :changed_labels=>0, :added_descriptions=>0, :removed_descriptions=>0, :changed_descriptions=>0, :added_sitelinks=>0, :removed_sitelinks=>0, :changed_sitelinks=>0, :added_forms=>0, :removed_forms=>0, :changed_forms=>1, :added_representations=>0, :removed_representations=>0, :changed_representations=>0, :added_formclaims=>0, :removed_formclaims=>0, :changed_formclaims=>0, :added_lemmas=>0, :removed_lemmas=>0, :changed_lemmas=>0, :added_senses=>0, :removed_senses=>0, :changed_senses=>0, :added_glosses=>0, :removed_glosses=>0, :changed_glosses=>0, :added_senseclaims=>0, :removed_senseclaims=>0, :changed_senseclaims=>0, :merge_to=>0, :merge_from=>0, :redirect=>0, :undo=>0, :restore=>0, :clear_item=>0, :create_item=>0, :create_property=>0, :create_lexeme=>0}, 1007242377=>{:added_claims=>1, :removed_claims=>0, :changed_claims=>0, :added_references=>0, :removed_references=>0, :changed_references=>0, :added_qualifiers=>1, :removed_qualifiers=>0, :changed_qualifiers=>0, :added_aliases=>0, :removed_aliases=>0, :changed_aliases=>0, :added_labels=>0, :removed_labels=>0, :changed_labels=>0, :added_descriptions=>0, :removed_descriptions=>0, :changed_descriptions=>0, :added_sitelinks=>0, :removed_sitelinks=>0, :changed_sitelinks=>0, :added_forms=>0, :removed_forms=>0, :changed_forms=>1, :added_representations=>0, :removed_representations=>0, :changed_representations=>0, :added_formclaims=>0, :removed_formclaims=>0, :changed_formclaims=>0, :added_lemmas=>0, :removed_lemmas=>0, :changed_lemmas=>0, :added_senses=>0, :removed_senses=>0, :changed_senses=>0, :added_glosses=>0, :removed_glosses=>0, :changed_glosses=>0, :added_senseclaims=>0, :removed_senseclaims=>0, :changed_senseclaims=>0, :merge_to=>0, :merge_from=>0, :redirect=>0, :undo=>0, :restore=>0, :clear_item=>0, :create_item=>0, :create_property=>0, :create_lexeme=>0}, 1007242410=>{:added_claims=>1, :removed_claims=>0, :changed_claims=>0, :added_references=>0, :removed_references=>0, :changed_references=>0, :added_qualifiers=>1, :removed_qualifiers=>0, :changed_qualifiers=>0, :added_aliases=>0, :removed_aliases=>0, :changed_aliases=>0, :added_labels=>0, :removed_labels=>0, :changed_labels=>0, :added_descriptions=>0, :removed_descriptions=>0, :changed_descriptions=>0, :added_sitelinks=>0, :removed_sitelinks=>0, :changed_sitelinks=>0, :added_forms=>0, :removed_forms=>0, :changed_forms=>1, :added_representations=>0, :removed_representations=>0, :changed_representations=>0, :added_formclaims=>0, :removed_formclaims=>0, :changed_formclaims=>0, :added_lemmas=>0, :removed_lemmas=>0, :changed_lemmas=>0, :added_senses=>0, :removed_senses=>0, :changed_senses=>0, :added_glosses=>0, :removed_glosses=>0, :changed_glosses=>0, :added_senseclaims=>0, :removed_senseclaims=>0, :changed_senseclaims=>0, :merge_to=>0, :merge_from=>0, :redirect=>0, :undo=>0, :restore=>0, :clear_item=>0, :create_item=>0, :create_property=>0, :create_lexeme=>0}, 1007242454=>{:added_claims=>0, :removed_claims=>0, :changed_claims=>0, :added_references=>0, :removed_references=>0, :changed_references=>0, :added_qualifiers=>0, :removed_qualifiers=>0, :changed_qualifiers=>0, :added_aliases=>0, :removed_aliases=>0, :changed_aliases=>0, :added_labels=>0, :removed_labels=>0, :changed_labels=>0, :added_descriptions=>0, :removed_descriptions=>0, :changed_descriptions=>0, :added_sitelinks=>0, :removed_sitelinks=>0, :changed_sitelinks=>0, :added_forms=>0, :removed_forms=>0, :changed_forms=>1, :added_representations=>0, :removed_representations=>0, :changed_representations=>0, :added_formclaims=>0, :removed_formclaims=>0, :changed_formclaims=>0, :added_lemmas=>0, :removed_lemmas=>0, :changed_lemmas=>0, :added_senses=>0, :removed_senses=>0, :changed_senses=>0, :added_glosses=>0, :removed_glosses=>0, :changed_glosses=>0, :added_senseclaims=>0, :removed_senseclaims=>0, :changed_senseclaims=>0, :merge_to=>0, :merge_from=>0, :redirect=>0, :undo=>0, :restore=>0, :clear_item=>0, :create_item=>0, :create_property=>0, :create_lexeme=>0}, 1007242480=>{:added_claims=>0, :removed_claims=>0, :changed_claims=>0, :added_references=>0, :removed_references=>0, :changed_references=>0, :added_qualifiers=>0, :removed_qualifiers=>0, :changed_qualifiers=>0, :added_aliases=>0, :removed_aliases=>0, :changed_aliases=>0, :added_labels=>0, :removed_labels=>0, :changed_labels=>0, :added_descriptions=>0, :removed_descriptions=>0, :changed_descriptions=>0, :added_sitelinks=>0, :removed_sitelinks=>0, :changed_sitelinks=>0, :added_forms=>0, :removed_forms=>0, :changed_forms=>1, :added_representations=>0, :removed_representations=>0, :changed_representations=>0, :added_formclaims=>0, :removed_formclaims=>0, :changed_formclaims=>1, :added_lemmas=>0, :removed_lemmas=>0, :changed_lemmas=>0, :added_senses=>0, :removed_senses=>0, :changed_senses=>0, :added_glosses=>0, :removed_glosses=>0, :changed_glosses=>0, :added_senseclaims=>0, :removed_senseclaims=>0, :changed_senseclaims=>0, :merge_to=>0, :merge_from=>0, :redirect=>0, :undo=>0, :restore=>0, :clear_item=>0, :create_item=>0, :create_property=>0, :create_lexeme=>0}, 1007242733=>{:added_claims=>1, :removed_claims=>0, :changed_claims=>0, :added_references=>0, :removed_references=>0, :changed_references=>0, :added_qualifiers=>0, :removed_qualifiers=>0, :changed_qualifiers=>0, :added_aliases=>0, :removed_aliases=>0, :changed_aliases=>0, :added_labels=>0, :removed_labels=>0, :changed_labels=>0, :added_descriptions=>0, :removed_descriptions=>0, :changed_descriptions=>0, :added_sitelinks=>0, :removed_sitelinks=>0, :changed_sitelinks=>0, :added_forms=>0, :removed_forms=>0, :changed_forms=>1, :added_representations=>0, :removed_representations=>0, :changed_representations=>0, :added_formclaims=>0, :removed_formclaims=>0, :changed_formclaims=>0, :added_lemmas=>0, :removed_lemmas=>0, :changed_lemmas=>0, :added_senses=>0, :removed_senses=>0, :changed_senses=>0, :added_glosses=>0, :removed_glosses=>0, :changed_glosses=>0, :added_senseclaims=>0, :removed_senseclaims=>0, :changed_senseclaims=>0, :merge_to=>0, :merge_from=>0, :redirect=>0, :undo=>0, :restore=>0, :clear_item=>0, :create_item=>0, :create_property=>0, :create_lexeme=>0}}, :total=>{:claims_added=>5, :claims_removed=>0, :claims_changed=>0, :references_added=>0, :references_removed=>0, :references_changed=>0, :qualifiers_added=>3, :qualifiers_removed=>0, :qualifiers_changed=>0, :aliases_added=>0, :aliases_removed=>0, :aliases_changed=>0, :labels_added=>0, :labels_removed=>0, :labels_changed=>0, :descriptions_added=>0, :descriptions_removed=>0, :descriptions_changed=>0, :sitelinks_added=>0, :sitelinks_removed=>0, :sitelinks_changed=>0, :lemmas_added=>1, :lemmas_removed=>0, :lemmas_changed=>0, :forms_added=>1, :forms_removed=>0, :forms_changed=>7, :representations_added=>1, :representations_removed=>0, :representations_changed=>0, :formclaims_added=>0, :formclaims_removed=>0, :formclaims_changed=>1, :senses_added=>0, :senses_removed=>0, :senses_changed=>0, :glosses_added=>0, :glosses_removed=>0, :glosses_changed=>0, :senseclaims_added=>0, :senseclaims_removed=>0, :senseclaims_changed=>0, :merge_to=>0, :merge_from=>0, :redirect=>0, :undo=>0, :restore=>0, :clear_item=>0, :create_item=>0, :create_property=>0, :create_lexeme=>1}}
  
      expect(analyzed_revisions).to eq(expected_result)
    end
  end